{
  "apps": [
    {
      "count": 40,
      "name": "app_server"
    },
    {
      "count": 11,
      "name": "python_script"
    },
    {
      "count": 9,
      "name": "batch_job"
    },
    {
      "count": 9,
      "name": "psql"
    },
    {
      "count": 5,
      "name": "pgadmin"
    },
    {
      "count": 4,
      "name": "metabase"
    },
    {
      "count": 3,
      "name": "reporting_tool"
    },
    {
      "count": 3,
      "name": "tableau"
    },
    {
      "count": 2,
      "name": "pg_dump"
    }
  ],
  "checkpoints": {
    "avg_checkpoint_time": "5.15 s",
    "events": [
      "2025-01-01 00:30:05",
      "2025-01-01 01:00:04",
      "2025-01-01 01:30:07",
      "2025-01-01 02:00:05",
      "2025-01-01 02:30:05",
      "2025-01-01 03:00:06",
      "2025-01-01 03:30:04",
      "2025-01-01 04:00:05",
      "2025-01-01 04:30:06",
      "2025-01-01 05:00:05",
      "2025-01-01 05:30:04",
      "2025-01-01 06:00:06",
      "2025-01-01 23:59:35"
    ],
    "max_checkpoint_time": "7.00 s",
    "total_checkpoints": 13,
    "types": {
      "time": {
        "count": 9,
        "events": [
          "2025-01-01 00:30:05",
          "2025-01-01 01:30:07",
          "2025-01-01 02:30:05",
          "2025-01-01 03:00:06",
          "2025-01-01 03:30:04",
          "2025-01-01 04:30:06",
          "2025-01-01 05:00:05",
          "2025-01-01 05:30:04",
          "2025-01-01 23:59:35"
        ],
        "percentage": 69.23076923076923,
        "rate_per_hour": 0.37510853835021707
      },
      "wal": {
        "count": 4,
        "events": [
          "2025-01-01 01:00:04",
          "2025-01-01 02:00:05",
          "2025-01-01 04:00:05",
          "2025-01-01 06:00:06"
        ],
        "percentage": 30.76923076923077,
        "rate_per_hour": 0.1667149059334298
      }
    }
  },
  "clients": {
    "unique_apps": 9,
    "unique_databases": 3,
    "unique_hosts": 37,
    "unique_users": 7
  },
  "connections": {
    "avg_connections_per_hour": "1.50",
    "avg_session_time": "1h14m6.550869565s",
    "connection_count": 36,
    "connections": [
      "2025-01-01 00:00:15",
      "2025-01-01 00:00:20",
      "2025-01-01 00:00:35",
      "2025-01-01 00:00:50",
      "2025-01-01 00:01:10",
      "2025-01-01 00:01:25",
      "2025-01-01 00:01:40",
      "2025-01-01 00:02:00",
      "2025-01-01 00:12:15",
      "2025-01-01 00:18:45",
      "2025-01-01 00:22:30",
      "2025-01-01 00:28:15",
      "2025-01-01 00:38:00",
      "2025-01-01 00:42:45",
      "2025-01-01 00:52:00",
      "2025-01-01 01:02:30",
      "2025-01-01 01:12:20",
      "2025-01-01 01:18:00",
      "2025-01-01 01:28:30",
      "2025-01-01 01:38:15",
      "2025-01-01 02:03:15",
      "2025-01-01 02:12:30",
      "2025-01-01 02:25:00",
      "2025-01-01 02:40:00",
      "2025-01-01 03:05:30",
      "2025-01-01 03:20:00",
      "2025-01-01 03:35:00",
      "2025-01-01 03:50:00",
      "2025-01-01 04:10:00",
      "2025-01-01 04:20:00",
      "2025-01-01 04:40:00",
      "2025-01-01 04:50:00",
      "2025-01-01 05:10:00",
      "2025-01-01 05:20:00",
      "2025-01-01 05:40:00",
      "2025-01-01 05:50:00"
    ],
    "disconnection_count": 23,
    "peak_concurrent_sessions": 36,
    "peak_concurrent_timestamp": "2025-01-01 05:50:00",
    "session_distribution": {
      "1min - 30min": 1,
      "1s - 1min": 0,
      "2h - 5h": 3,
      "30min - 2h": 19,
      "< 1s": 0,
      "> 5h": 0
    },
    "session_stats": {
      "avg_duration": "1h14m6.550869565s",
      "count": 23,
      "cumulated_duration": "28h24m30.67s",
      "max_duration": "2h20m15.89s",
      "median_duration": "1h17m45.123s",
      "min_duration": "7m10.234s"
    },
    "sessions_by_database": {
      "analytics_db": {
        "avg_duration": "1h2m53.641333333s",
        "count": 3,
        "cumulated_duration": "3h8m40.924s",
        "max_duration": "1h17m45.123s",
        "median_duration": "1h3m25.678s",
        "min_duration": "47m30.123s"
      },
      "app_db": {
        "avg_duration": "1h19m42.3505625s",
        "count": 16,
        "cumulated_duration": "21h15m17.609s",
        "max_duration": "2h20m15.89s",
        "median_duration": "1h22m18.178s",
        "min_duration": "7m10.234s"
      },
      "postgres": {
        "avg_duration": "1h0m8.03425s",
        "count": 4,
        "cumulated_duration": "4h0m32.137s",
        "max_duration": "1h44m45.234s",
        "median_duration": "46m30.5065s",
        "min_duration": "42m45.89s"
      }
    },
    "sessions_by_host": {
      "0:52:00.567": {
        "avg_duration": "1h13m10.456s",
        "count": 1,
        "cumulated_duration": "1h13m10.456s",
        "max_duration": "1h13m10.456s",
        "median_duration": "1h13m10.456s",
        "min_duration": "1h13m10.456s"
      },
      "10.0.1.100": {
        "avg_duration": "2h0m30.234s",
        "count": 1,
        "cumulated_duration": "2h0m30.234s",
        "max_duration": "2h0m30.234s",
        "median_duration": "2h0m30.234s",
        "min_duration": "2h0m30.234s"
      },
      "10.0.1.50": {
        "avg_duration": "1h17m45.123s",
        "count": 1,
        "cumulated_duration": "1h17m45.123s",
        "max_duration": "1h17m45.123s",
        "median_duration": "1h17m45.123s",
        "min_duration": "1h17m45.123s"
      },
      "10.0.1.51": {
        "avg_duration": "1h21m45.678s",
        "count": 1,
        "cumulated_duration": "1h21m45.678s",
        "max_duration": "1h21m45.678s",
        "median_duration": "1h21m45.678s",
        "min_duration": "1h21m45.678s"
      },
      "10.0.1.90": {
        "avg_duration": "1h46m0.345s",
        "count": 1,
        "cumulated_duration": "1h46m0.345s",
        "max_duration": "1h46m0.345s",
        "median_duration": "1h46m0.345s",
        "min_duration": "1h46m0.345s"
      },
      "10.0.2.30": {
        "avg_duration": "47m30.123s",
        "count": 1,
        "cumulated_duration": "47m30.123s",
        "max_duration": "47m30.123s",
        "median_duration": "47m30.123s",
        "min_duration": "47m30.123s"
      },
      "10.0.2.40": {
        "avg_duration": "1h3m25.678s",
        "count": 1,
        "cumulated_duration": "1h3m25.678s",
        "max_duration": "1h3m25.678s",
        "median_duration": "1h3m25.678s",
        "min_duration": "1h3m25.678s"
      },
      "172.16.0.10": {
        "avg_duration": "1h33m40.234s",
        "count": 1,
        "cumulated_duration": "1h33m40.234s",
        "max_duration": "1h33m40.234s",
        "median_duration": "1h33m40.234s",
        "min_duration": "1h33m40.234s"
      },
      "172.16.0.11": {
        "avg_duration": "2h6m45.789s",
        "count": 1,
        "cumulated_duration": "2h6m45.789s",
        "max_duration": "2h6m45.789s",
        "median_duration": "2h6m45.789s",
        "min_duration": "2h6m45.789s"
      },
      "172.16.0.12": {
        "avg_duration": "1h52m45.567s",
        "count": 1,
        "cumulated_duration": "1h52m45.567s",
        "max_duration": "1h52m45.567s",
        "median_duration": "1h52m45.567s",
        "min_duration": "1h52m45.567s"
      },
      "172.16.0.30": {
        "avg_duration": "37m45.234s",
        "count": 1,
        "cumulated_duration": "37m45.234s",
        "max_duration": "37m45.234s",
        "median_duration": "37m45.234s",
        "min_duration": "37m45.234s"
      },
      "172.16.0.40": {
        "avg_duration": "2h20m15.89s",
        "count": 1,
        "cumulated_duration": "2h20m15.89s",
        "max_duration": "2h20m15.89s",
        "median_duration": "2h20m15.89s",
        "min_duration": "2h20m15.89s"
      },
      "172.16.0.60": {
        "avg_duration": "1h22m50.678s",
        "count": 1,
        "cumulated_duration": "1h22m50.678s",
        "max_duration": "1h22m50.678s",
        "median_duration": "1h22m50.678s",
        "min_duration": "1h22m50.678s"
      },
      "172.16.0.70": {
        "avg_duration": "1h30m45.567s",
        "count": 1,
        "cumulated_duration": "1h30m45.567s",
        "max_duration": "1h30m45.567s",
        "median_duration": "1h30m45.567s",
        "min_duration": "1h30m45.567s"
      },
      "172.16.0.80": {
        "avg_duration": "1h20m40.89s",
        "count": 1,
        "cumulated_duration": "1h20m40.89s",
        "max_duration": "1h20m40.89s",
        "median_duration": "1h20m40.89s",
        "min_duration": "1h20m40.89s"
      },
      "192.168.1.100": {
        "avg_duration": "31m5.567s",
        "count": 1,
        "cumulated_duration": "31m5.567s",
        "max_duration": "31m5.567s",
        "median_duration": "31m5.567s",
        "min_duration": "31m5.567s"
      },
      "192.168.1.101": {
        "avg_duration": "7m10.234s",
        "count": 1,
        "cumulated_duration": "7m10.234s",
        "max_duration": "7m10.234s",
        "median_duration": "7m10.234s",
        "min_duration": "7m10.234s"
      },
      "192.168.1.102": {
        "avg_duration": "42m45.89s",
        "count": 1,
        "cumulated_duration": "42m45.89s",
        "max_duration": "42m45.89s",
        "median_duration": "42m45.89s",
        "min_duration": "42m45.89s"
      },
      "192.168.1.104": {
        "avg_duration": "33m20.123s",
        "count": 1,
        "cumulated_duration": "33m20.123s",
        "max_duration": "33m20.123s",
        "median_duration": "33m20.123s",
        "min_duration": "33m20.123s"
      },
      "192.168.1.105": {
        "avg_duration": "47m30.89s",
        "count": 1,
        "cumulated_duration": "47m30.89s",
        "max_duration": "47m30.89s",
        "median_duration": "47m30.89s",
        "min_duration": "47m30.89s"
      },
      "192.168.1.106": {
        "avg_duration": "1h44m45.234s",
        "count": 1,
        "cumulated_duration": "1h44m45.234s",
        "max_duration": "1h44m45.234s",
        "median_duration": "1h44m45.234s",
        "min_duration": "1h44m45.234s"
      },
      "192.168.1.107": {
        "avg_duration": "45m30.123s",
        "count": 1,
        "cumulated_duration": "45m30.123s",
        "max_duration": "45m30.123s",
        "median_duration": "45m30.123s",
        "min_duration": "45m30.123s"
      },
      "192.168.1.150": {
        "avg_duration": "56m45.123s",
        "count": 1,
        "cumulated_duration": "56m45.123s",
        "max_duration": "56m45.123s",
        "median_duration": "56m45.123s",
        "min_duration": "56m45.123s"
      }
    },
    "sessions_by_user": {
      "admin": {
        "avg_duration": "45m15.634333333s",
        "count": 3,
        "cumulated_duration": "2h15m46.903s",
        "max_duration": "47m30.89s",
        "median_duration": "45m30.123s",
        "min_duration": "42m45.89s"
      },
      "analytics": {
        "avg_duration": "1h17m45.123s",
        "count": 1,
        "cumulated_duration": "1h17m45.123s",
        "max_duration": "1h17m45.123s",
        "median_duration": "1h17m45.123s",
        "min_duration": "1h17m45.123s"
      },
      "app_user": {
        "avg_duration": "1h26m58.5872s",
        "count": 10,
        "cumulated_duration": "14h29m45.872s",
        "max_duration": "2h20m15.89s",
        "median_duration": "1h26m48.1225s",
        "min_duration": "31m5.567s"
      },
      "backup_user": {
        "avg_duration": "1h44m45.234s",
        "count": 1,
        "cumulated_duration": "1h44m45.234s",
        "max_duration": "1h44m45.234s",
        "median_duration": "1h44m45.234s",
        "min_duration": "1h44m45.234s"
      },
      "batch_user": {
        "avg_duration": "1h42m45.419s",
        "count": 3,
        "cumulated_duration": "5h8m16.257s",
        "max_duration": "2h0m30.234s",
        "median_duration": "1h46m0.345s",
        "min_duration": "1h21m45.678s"
      },
      "readonly": {
        "avg_duration": "41m38.2562s",
        "count": 5,
        "cumulated_duration": "3h28m11.281s",
        "max_duration": "1h3m25.678s",
        "median_duration": "47m30.123s",
        "min_duration": "7m10.234s"
      }
    }
  },
  "databases": [
    {
      "count": 104,
      "name": "app_db"
    },
    {
      "count": 25,
      "name": "analytics_db"
    },
    {
      "count": 16,
      "name": "postgres"
    }
  ],
  "events": [
    {
      "count": 183,
      "percentage": 98.38709677419355,
      "type": "LOG"
    },
    {
      "count": 2,
      "percentage": 1.0752688172043012,
      "type": "ERROR"
    },
    {
      "count": 1,
      "percentage": 0.5376344086021506,
      "type": "WARNING"
    }
  ],
  "hosts": [
    {
      "count": 2,
      "name": "10.0.1.100"
    },
    {
      "count": 2,
      "name": "10.0.1.50"
    },
    {
      "count": 2,
      "name": "10.0.1.51"
    },
    {
      "count": 2,
      "name": "10.0.1.90"
    },
    {
      "count": 2,
      "name": "10.0.2.30"
    },
    {
      "count": 2,
      "name": "10.0.2.40"
    },
    {
      "count": 2,
      "name": "172.16.0.10"
    },
    {
      "count": 2,
      "name": "172.16.0.11"
    },
    {
      "count": 2,
      "name": "172.16.0.12"
    },
    {
      "count": 2,
      "name": "172.16.0.30"
    },
    {
      "count": 2,
      "name": "172.16.0.40"
    },
    {
      "count": 2,
      "name": "172.16.0.60"
    },
    {
      "count": 2,
      "name": "172.16.0.70"
    },
    {
      "count": 2,
      "name": "172.16.0.80"
    },
    {
      "count": 2,
      "name": "192.168.1.100"
    },
    {
      "count": 2,
      "name": "192.168.1.101"
    },
    {
      "count": 2,
      "name": "192.168.1.102"
    },
    {
      "count": 2,
      "name": "192.168.1.104"
    },
    {
      "count": 2,
      "name": "192.168.1.105"
    },
    {
      "count": 2,
      "name": "192.168.1.106"
    },
    {
      "count": 2,
      "name": "192.168.1.107"
    },
    {
      "count": 2,
      "name": "192.168.1.150"
    },
    {
      "count": 1,
      "name": "0:52:00.567"
    },
    {
      "count": 1,
      "name": "10.0.1.110"
    },
    {
      "count": 1,
      "name": "10.0.1.80"
    },
    {
      "count": 1,
      "name": "10.0.2.50"
    },
    {
      "count": 1,
      "name": "10.0.2.60"
    },
    {
      "count": 1,
      "name": "172.16.0.100"
    },
    {
      "count": 1,
      "name": "172.16.0.110"
    },
    {
      "count": 1,
      "name": "172.16.0.120"
    },
    {
      "count": 1,
      "name": "172.16.0.20"
    },
    {
      "count": 1,
      "name": "172.16.0.50"
    },
    {
      "count": 1,
      "name": "172.16.0.90"
    },
    {
      "count": 1,
      "name": "192.168.1.103"
    },
    {
      "count": 1,
      "name": "192.168.1.108"
    },
    {
      "count": 1,
      "name": "192.168.1.109"
    },
    {
      "count": 1,
      "name": "192.168.1.200"
    }
  ],
  "locks": {
    "acquired_events": 4,
    "avg_wait_time": "757.94 ms",
    "events": [
      {
        "event_type": "waiting",
        "lock_type": "ShareLock",
        "process_id": "70150",
        "resource_type": "transaction",
        "timestamp": "2025-01-01 01:18:30",
        "wait_time": "1000.12 ms"
      },
      {
        "event_type": "waiting",
        "lock_type": "ShareLock",
        "process_id": "70151",
        "resource_type": "transaction",
        "timestamp": "2025-01-01 01:18:31",
        "wait_time": "1000.46 ms"
      },
      {
        "event_type": "waiting",
        "lock_type": "ShareLock",
        "process_id": "70152",
        "resource_type": "transaction",
        "timestamp": "2025-01-01 01:18:32",
        "wait_time": "1000.79 ms"
      },
      {
        "event_type": "acquired",
        "lock_type": "ShareLock",
        "process_id": "70150",
        "query_id": "up-6oT4b3",
        "resource_type": "transaction",
        "timestamp": "2025-01-01 01:18:33",
        "wait_time": "3456.79 ms"
      },
      {
        "event_type": "waiting",
        "lock_type": "ShareLock",
        "process_id": "70151",
        "query_id": "up-N6vKXC",
        "resource_type": "transaction",
        "timestamp": "2025-01-01 01:18:33",
        "wait_time": "2234.57 ms"
      },
      {
        "event_type": "waiting",
        "lock_type": "ExclusiveLock",
        "process_id": "70153",
        "resource_type": "tuple",
        "timestamp": "2025-01-01 01:18:34",
        "wait_time": "1000.23 ms"
      },
      {
        "event_type": "acquired",
        "lock_type": "ShareLock",
        "process_id": "70152",
        "query_id": "up-6oT4b3",
        "resource_type": "transaction",
        "timestamp": "2025-01-01 01:18:34",
        "wait_time": "2567.89 ms"
      },
      {
        "event_type": "waiting",
        "lock_type": "ShareLock",
        "process_id": "70151",
        "query_id": "up-N6vKXC",
        "resource_type": "transaction",
        "timestamp": "2025-01-01 01:18:35",
        "wait_time": "4345.68 ms"
      },
      {
        "event_type": "acquired",
        "lock_type": "AccessShareLock",
        "process_id": "70154",
        "resource_type": "relation",
        "timestamp": "2025-01-01 01:18:36",
        "wait_time": "523.46 ms"
      },
      {
        "event_type": "waiting",
        "lock_type": "AccessShareLock",
        "process_id": "70155",
        "resource_type": "relation",
        "timestamp": "2025-01-01 01:18:37",
        "wait_time": "1000.11 ms"
      },
      {
        "event_type": "acquired",
        "lock_type": "AccessShareLock",
        "process_id": "70155",
        "query_id": "se-I5oJov",
        "resource_type": "relation",
        "timestamp": "2025-01-01 01:18:38",
        "wait_time": "1789.22 ms"
      }
    ],
    "lock_type_stats": {
      "AccessShareLock": 3,
      "ExclusiveLock": 1,
      "ShareLock": 7
    },
    "queries": [
      {
        "acquired_count": 1,
        "acquired_wait_time": "523.46 ms",
        "id": "an-BdkPcf",
        "normalized_query": "analyze orders;",
        "raw_query": "ANALYZE orders;",
        "still_waiting_count": 0,
        "still_waiting_time": "0.00 ms",
        "total_wait_time": "523.46 ms"
      },
      {
        "acquired_count": 1,
        "acquired_wait_time": "1789.22 ms",
        "id": "se-I5oJov",
        "normalized_query": "select * from users where id = ? for update;",
        "raw_query": "SELECT * FROM users WHERE id = 42 FOR UPDATE;",
        "still_waiting_count": 1,
        "still_waiting_time": "1000.23 ms",
        "total_wait_time": "2789.46 ms"
      },
      {
        "acquired_count": 2,
        "acquired_wait_time": "6024.68 ms",
        "id": "up-6oT4b3",
        "normalized_query": "update orders set status = ? where id = ?;",
        "raw_query": "UPDATE orders SET status = 'shipped' WHERE id = 500;",
        "still_waiting_count": 0,
        "still_waiting_time": "0.00 ms",
        "total_wait_time": "6024.68 ms"
      },
      {
        "acquired_count": 0,
        "acquired_wait_time": "0.00 ms",
        "id": "up-N6vKXC",
        "normalized_query": "update products set stock = stock - ? where id = ?;",
        "raw_query": "UPDATE products SET stock = stock - 1 WHERE id = 250;",
        "still_waiting_count": 1,
        "still_waiting_time": "4345.68 ms",
        "total_wait_time": "4345.68 ms"
      }
    ],
    "resource_type_stats": {
      "relation": 3,
      "transaction": 7,
      "tuple": 1
    },
    "total_events": 11,
    "total_wait_time": "8.34 s",
    "waiting_events": 7
  },
  "maintenance": {
    "analyze_count": 2,
    "analyze_table_counts": {
      "app_db.public.orders": 1,
      "app_db.public.products": 1
    },
    "vacuum_count": 2,
    "vacuum_space_recovered": {
      "app_db.public.sessions": "1.00 MB"
    },
    "vacuum_table_counts": {
      "app_db.public.orders": 1,
      "app_db.public.sessions": 1
    }
  },
  "sql_performance": {
    "executions": [
      {
        "duration": "45 ms",
        "query_id": "se-wjIaKQ",
        "timestamp": "2025-01-01 00:00:16"
      },
      {
        "duration": "1.25 s",
        "query_id": "se-fewGrD",
        "timestamp": "2025-01-01 00:05:00"
      },
      {
        "duration": "89 ms",
        "query_id": "se-0jc0Bm",
        "timestamp": "2025-01-01 00:05:01"
      },
      {
        "duration": "432 ms",
        "query_id": "up-6oT4b3",
        "timestamp": "2025-01-01 00:05:02"
      },
      {
        "duration": "2.15 s",
        "query_id": "se-qjYEBI",
        "timestamp": "2025-01-01 00:15:00"
      },
      {
        "duration": "8.95 s",
        "query_id": "se-artDBI",
        "timestamp": "2025-01-01 00:15:04"
      },
      {
        "duration": "67 ms",
        "query_id": "in-cLbna3",
        "timestamp": "2025-01-01 00:25:00"
      },
      {
        "duration": "15.23 s",
        "query_id": "up-TTbMVk",
        "timestamp": "2025-01-01 00:35:00"
      },
      {
        "duration": "156 ms",
        "query_id": "se-8UPbX1",
        "timestamp": "2025-01-01 00:40:00"
      },
      {
        "duration": "234 ms",
        "query_id": "be-P6SWQR",
        "timestamp": "2025-01-01 00:45:00"
      },
      {
        "duration": "5.68 s",
        "query_id": "se-tLDSoK",
        "timestamp": "2025-01-01 01:05:00"
      },
      {
        "duration": "6.23 s",
        "query_id": "se-t5xfLG",
        "timestamp": "2025-01-01 01:08:50"
      },
      {
        "duration": "89 ms",
        "query_id": "de-bBueyy",
        "timestamp": "2025-01-01 01:10:00"
      },
      {
        "duration": "12.35 s",
        "query_id": "cr-wgSzpj",
        "timestamp": "2025-01-01 01:25:10"
      },
      {
        "duration": "9.88 s",
        "query_id": "se-r0bek4",
        "timestamp": "2025-01-01 01:42:08"
      },
      {
        "duration": "299 ms",
        "query_id": "de-CObqgd",
        "timestamp": "2025-01-01 02:05:00"
      },
      {
        "duration": "14.57 s",
        "query_id": "wi-jxdKj2",
        "timestamp": "2025-01-01 02:15:12"
      },
      {
        "duration": "11.23 s",
        "query_id": "se-BPyDv3",
        "timestamp": "2025-01-01 02:45:40"
      },
      {
        "duration": "10.12 s",
        "query_id": "in-Vv5Ky5",
        "timestamp": "2025-01-01 03:10:09"
      },
      {
        "duration": "7.89 s",
        "query_id": "se-aBpbzd",
        "timestamp": "2025-01-01 03:40:21"
      },
      {
        "duration": "9.46 s",
        "query_id": "up-tiXPwa",
        "timestamp": "2025-01-01 03:55:38"
      },
      {
        "duration": "11.79 s",
        "query_id": "wi-dcjqlQ",
        "timestamp": "2025-01-01 04:25:55"
      },
      {
        "duration": "9.01 s",
        "query_id": "de-NvyXk4",
        "timestamp": "2025-01-01 04:55:38"
      },
      {
        "duration": "10.35 s",
        "query_id": "se-icbHlE",
        "timestamp": "2025-01-01 05:25:24"
      },
      {
        "duration": "12.68 s",
        "query_id": "wi-T9XAxn",
        "timestamp": "2025-01-01 05:55:26"
      }
    ],
    "queries": [
      {
        "avg_time_ms": 234.56,
        "count": 1,
        "id": "be-P6SWQR",
        "max_time_ms": 234.56,
        "normalized_query": "begin;",
        "raw_query": "BEGIN;",
        "total_time_ms": 234.56
      },
      {
        "avg_time_ms": 12345.67,
        "count": 1,
        "id": "cr-wgSzpj",
        "max_time_ms": 12345.67,
        "normalized_query": "create temporary table tmp_aggregates as select user_id, date(created_at) as date, count(*) as event_count from events where created_at > now() - interval ? group by user_id, date(created_at);",
        "raw_query": "CREATE TEMPORARY TABLE tmp_aggregates AS SELECT user_id, DATE(created_at) as date, COUNT(*) as event_count FROM events WHERE created_at > NOW() - INTERVAL '90 days' GROUP BY user_id, DATE(created_at);",
        "total_time_ms": 12345.67
      },
      {
        "avg_time_ms": 299.99,
        "count": 1,
        "id": "de-CObqgd",
        "max_time_ms": 299.99,
        "normalized_query": "delete from audit_logs where created_at < now() - interval ?;",
        "raw_query": "DELETE FROM audit_logs WHERE created_at < NOW() - INTERVAL '90 days';",
        "total_time_ms": 299.99
      },
      {
        "avg_time_ms": 9012.34,
        "count": 1,
        "id": "de-NvyXk4",
        "max_time_ms": 9012.34,
        "normalized_query": "delete from session_logs where created_at < now() - interval ? and session_id not in (select id from active_sessions);",
        "raw_query": "DELETE FROM session_logs WHERE created_at < NOW() - INTERVAL '30 days' AND session_id NOT IN (SELECT id FROM active_sessions);",
        "total_time_ms": 9012.34
      },
      {
        "avg_time_ms": 89.12,
        "count": 1,
        "id": "de-bBueyy",
        "max_time_ms": 89.12,
        "normalized_query": "delete from sessions where expires_at < now();",
        "raw_query": "DELETE FROM sessions WHERE expires_at < NOW();",
        "total_time_ms": 89.12
      },
      {
        "avg_time_ms": 10123.45,
        "count": 1,
        "id": "in-Vv5Ky5",
        "max_time_ms": 10123.45,
        "normalized_query": "insert into monthly_reports (month, total_orders, total_revenue, avg_order_value) select date_trunc(?, created_at) as month, count(*) as total_orders, sum(total) as total_revenue, avg(total) as avg_order_value from orders where created_at >= date_trunc(?, current_date - interval ?) and created_at < date_trunc(?, current_date) group by month;",
        "raw_query": "INSERT INTO monthly_reports (month, total_orders, total_revenue, avg_order_value) SELECT DATE_TRUNC('month', created_at) as month, COUNT(*) as total_orders, SUM(total) as total_revenue, AVG(total) as avg_order_value FROM orders WHERE created_at >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '1 month') AND created_at < DATE_TRUNC('month', CURRENT_DATE) GROUP BY month;",
        "total_time_ms": 10123.45
      },
      {
        "avg_time_ms": 67.89,
        "count": 1,
        "id": "in-cLbna3",
        "max_time_ms": 67.89,
        "normalized_query": "insert into sessions (user_id, token, expires_at) values (?, ?, ?);",
        "raw_query": "INSERT INTO sessions (user_id, token, expires_at) VALUES (42, 'abc123', '2025-01-02 00:25:00');",
        "total_time_ms": 67.89
      },
      {
        "avg_time_ms": 89.45,
        "count": 1,
        "id": "se-0jc0Bm",
        "max_time_ms": 89.45,
        "normalized_query": "select * from orders where user_id = ? order by created_at desc limit ?;",
        "raw_query": "SELECT * FROM orders WHERE user_id = 42 ORDER BY created_at DESC LIMIT 10;",
        "total_time_ms": 89.45
      },
      {
        "avg_time_ms": 156.23,
        "count": 1,
        "id": "se-8UPbX1",
        "max_time_ms": 156.23,
        "normalized_query": "select id, name, email from users where last_login > now() - interval ? order by last_login desc;",
        "raw_query": "SELECT id, name, email FROM users WHERE last_login > NOW() - INTERVAL '1 day' ORDER BY last_login DESC;",
        "total_time_ms": 156.23
      },
      {
        "avg_time_ms": 11234.56,
        "count": 1,
        "id": "se-BPyDv3",
        "max_time_ms": 11234.56,
        "normalized_query": "select date(o.created_at) as order_date, p.category, sum(oi.quantity * oi.price) as daily_revenue, count(distinct o.user_id) as unique_customers from orders o join order_items oi on o.id = oi.order_id join products p on oi.product_id = p.id where o.created_at > now() - interval ? group by order_date, p.category order by order_date desc, daily_revenue desc;",
        "raw_query": "SELECT DATE(o.created_at) as order_date, p.category, SUM(oi.quantity * oi.price) as daily_revenue, COUNT(DISTINCT o.user_id) as unique_customers FROM orders o JOIN order_items oi ON o.id = oi.order_id JOIN products p ON oi.product_id = p.id WHERE o.created_at > NOW() - INTERVAL '90 days' GROUP BY order_date, p.category ORDER BY order_date DESC, daily_revenue DESC;",
        "total_time_ms": 11234.56
      },
      {
        "avg_time_ms": 7890.12,
        "count": 1,
        "id": "se-aBpbzd",
        "max_time_ms": 7890.12,
        "normalized_query": "select p.name, p.category, count(distinct oi.order_id) as times_ordered, sum(oi.quantity) as total_quantity_sold, sum(oi.quantity * oi.price) as total_revenue from products p join order_items oi on p.id = oi.product_id join orders o on oi.order_id = o.id where o.created_at > now() - interval ? group by p.id, p.name, p.category having count(distinct oi.order_id) > ? order by total_revenue desc;",
        "raw_query": "SELECT p.name, p.category, COUNT(DISTINCT oi.order_id) as times_ordered, SUM(oi.quantity) as total_quantity_sold, SUM(oi.quantity * oi.price) as total_revenue FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.created_at > NOW() - INTERVAL '180 days' GROUP BY p.id, p.name, p.category HAVING COUNT(DISTINCT oi.order_id) > 50 ORDER BY total_revenue DESC;",
        "total_time_ms": 7890.12
      },
      {
        "avg_time_ms": 8945.67,
        "count": 1,
        "id": "se-artDBI",
        "max_time_ms": 8945.67,
        "normalized_query": "select date_trunc(?, created_at) as hour, count(*) as count, avg(total) as avg_total from orders where created_at > now() - interval ? group by hour order by hour;",
        "raw_query": "SELECT date_trunc('hour', created_at) as hour, COUNT(*) as count, AVG(total) as avg_total FROM orders WHERE created_at > NOW() - INTERVAL '7 days' GROUP BY hour ORDER BY hour;",
        "total_time_ms": 8945.67
      },
      {
        "avg_time_ms": 1250.32,
        "count": 1,
        "id": "se-fewGrD",
        "max_time_ms": 1250.32,
        "normalized_query": "select * from users where id = ?;",
        "raw_query": "SELECT * FROM users WHERE id = 42;",
        "total_time_ms": 1250.32
      },
      {
        "avg_time_ms": 10345.67,
        "count": 1,
        "id": "se-icbHlE",
        "max_time_ms": 10345.67,
        "normalized_query": "select category, count(*) as total_products, avg(price) as avg_price, min(price) as min_price, max(price) as max_price, sum(stock) as total_stock from products where active = true group by category order by total_products desc;",
        "raw_query": "SELECT category, COUNT(*) as total_products, AVG(price) as avg_price, MIN(price) as min_price, MAX(price) as max_price, SUM(stock) as total_stock FROM products WHERE active = true GROUP BY category ORDER BY total_products DESC;",
        "total_time_ms": 10345.67
      },
      {
        "avg_time_ms": 2150.88,
        "count": 1,
        "id": "se-qjYEBI",
        "max_time_ms": 2150.88,
        "normalized_query": "select u.id, u.name, count(o.id) as order_count, sum(o.total) as total_spent from users u left join orders o on u.id = o.user_id where u.created_at > ? group by u.id, u.name order by total_spent desc limit ?;",
        "raw_query": "SELECT u.id, u.name, COUNT(o.id) as order_count, SUM(o.total) as total_spent FROM users u LEFT JOIN orders o ON u.id = o.user_id WHERE u.created_at > '2024-01-01' GROUP BY u.id, u.name ORDER BY total_spent DESC LIMIT 100;",
        "total_time_ms": 2150.88
      },
      {
        "avg_time_ms": 9876.54,
        "count": 1,
        "id": "se-r0bek4",
        "max_time_ms": 9876.54,
        "normalized_query": "select category, subcategory, count(*) as product_count, avg(price) as avg_price from products where active = true group by category, subcategory order by category, product_count desc;",
        "raw_query": "SELECT category, subcategory, COUNT(*) as product_count, AVG(price) as avg_price FROM products WHERE active = true GROUP BY category, subcategory ORDER BY category, product_count DESC;",
        "total_time_ms": 9876.54
      },
      {
        "avg_time_ms": 6234.56,
        "count": 1,
        "id": "se-t5xfLG",
        "max_time_ms": 6234.56,
        "normalized_query": "select product_id, count(*) as view_count, avg(duration) as avg_duration from product_views where timestamp > now() - interval ? group by product_id order by view_count desc;",
        "raw_query": "SELECT product_id, COUNT(*) as view_count, AVG(duration) as avg_duration FROM product_views WHERE timestamp > NOW() - INTERVAL '7 days' GROUP BY product_id ORDER BY view_count DESC;",
        "total_time_ms": 6234.56
      },
      {
        "avg_time_ms": 5678.9,
        "count": 1,
        "id": "se-tLDSoK",
        "max_time_ms": 5678.9,
        "normalized_query": "select date_trunc(?, o.created_at) as day, p.category, count(distinct o.id) as order_count, sum(oi.quantity * oi.price) as revenue from orders o join order_items oi on o.id = oi.order_id join products p on oi.product_id = p.id where o.created_at > now() - interval ? group by day, p.category order by day desc, revenue desc;",
        "raw_query": "SELECT date_trunc('day', o.created_at) as day, p.category, COUNT(DISTINCT o.id) as order_count, SUM(oi.quantity * oi.price) as revenue FROM orders o JOIN order_items oi ON o.id = oi.order_id JOIN products p ON oi.product_id = p.id WHERE o.created_at > NOW() - INTERVAL '30 days' GROUP BY day, p.category ORDER BY day DESC, revenue DESC;",
        "total_time_ms": 5678.9
      },
      {
        "avg_time_ms": 45.23,
        "count": 1,
        "id": "se-wjIaKQ",
        "max_time_ms": 45.23,
        "normalized_query": "select version();",
        "raw_query": "SELECT version();",
        "total_time_ms": 45.23
      },
      {
        "avg_time_ms": 432.17,
        "count": 1,
        "id": "up-6oT4b3",
        "max_time_ms": 432.17,
        "normalized_query": "update orders set status = ? where id = ?;",
        "raw_query": "UPDATE orders SET status = 'shipped' WHERE id = 1234;",
        "total_time_ms": 432.17
      },
      {
        "avg_time_ms": 15234.56,
        "count": 1,
        "id": "up-TTbMVk",
        "max_time_ms": 15234.56,
        "normalized_query": "update products set stock = stock - orders_temp.quantity from (select product_id, sum(quantity) as quantity from order_items where order_id in (select id from orders where status = ?)) as orders_temp where products.id = orders_temp.product_id;",
        "raw_query": "UPDATE products SET stock = stock - orders_temp.quantity FROM (SELECT product_id, SUM(quantity) as quantity FROM order_items WHERE order_id IN (SELECT id FROM orders WHERE status = 'pending')) as orders_temp WHERE products.id = orders_temp.product_id;",
        "total_time_ms": 15234.56
      },
      {
        "avg_time_ms": 9456.78,
        "count": 1,
        "id": "up-tiXPwa",
        "max_time_ms": 9456.78,
        "normalized_query": "update user_statistics set total_orders = sq.order_count, total_spent = sq.total_spent, last_order_date = sq.last_order, updated_at = now() from ( select user_id, count(*) as order_count, sum(total) as total_spent, max(created_at) as last_order from orders group by user_id ) sq where user_statistics.user_id = sq.user_id;",
        "raw_query": "UPDATE user_statistics SET total_orders = sq.order_count, total_spent = sq.total_spent, last_order_date = sq.last_order, updated_at = NOW() FROM ( SELECT user_id, COUNT(*) as order_count, SUM(total) as total_spent, MAX(created_at) as last_order FROM orders GROUP BY user_id ) sq WHERE user_statistics.user_id = sq.user_id;",
        "total_time_ms": 9456.78
      },
      {
        "avg_time_ms": 12678.9,
        "count": 1,
        "id": "wi-T9XAxn",
        "max_time_ms": 12678.9,
        "normalized_query": "with cohort_data as ( select user_id, date_trunc(?, min(created_at)) as cohort_month, date_trunc(?, created_at) as order_month, count(*) as order_count from orders where created_at > now() - interval ? group by user_id, cohort_month, order_month ) select cohort_month, order_month, count(distinct user_id) as active_users, sum(order_count) as total_orders from cohort_data group by cohort_month, order_month order by cohort_month, order_month;",
        "raw_query": "WITH cohort_data AS ( SELECT user_id, DATE_TRUNC('month', MIN(created_at)) as cohort_month, DATE_TRUNC('month', created_at) as order_month, COUNT(*) as order_count FROM orders WHERE created_at > NOW() - INTERVAL '12 months' GROUP BY user_id, cohort_month, order_month ) SELECT cohort_month, order_month, COUNT(DISTINCT user_id) as active_users, SUM(order_count) as total_orders FROM cohort_data GROUP BY cohort_month, order_month ORDER BY cohort_month, order_month;",
        "total_time_ms": 12678.9
      },
      {
        "avg_time_ms": 11789.34,
        "count": 1,
        "id": "wi-dcjqlQ",
        "max_time_ms": 11789.34,
        "normalized_query": "with daily_metrics as ( select date(created_at) as date, user_id, count(*) as daily_events, sum(duration) as daily_duration from user_events where created_at > now() - interval ? group by date, user_id ) select user_id, avg(daily_events) as avg_daily_events, avg(daily_duration) as avg_daily_duration, max(daily_events) as max_daily_events from daily_metrics group by user_id having avg(daily_events) > ? order by avg_daily_events desc;",
        "raw_query": "WITH daily_metrics AS ( SELECT DATE(created_at) as date, user_id, COUNT(*) as daily_events, SUM(duration) as daily_duration FROM user_events WHERE created_at > NOW() - INTERVAL '30 days' GROUP BY date, user_id ) SELECT user_id, AVG(daily_events) as avg_daily_events, AVG(daily_duration) as avg_daily_duration, MAX(daily_events) as max_daily_events FROM daily_metrics GROUP BY user_id HAVING AVG(daily_events) > 10 ORDER BY avg_daily_events DESC;",
        "total_time_ms": 11789.34
      },
      {
        "avg_time_ms": 14567.89,
        "count": 1,
        "id": "wi-jxdKj2",
        "max_time_ms": 14567.89,
        "normalized_query": "with user_segments as ( select user_id, case when total_orders > ? then ? when total_orders > ? then ? else ? end as segment from (select user_id, count(*) as total_orders from orders group by user_id) sq ) select segment, count(*) as user_count, avg(total_spent) as avg_spent from user_segments us join (select user_id, sum(total) as total_spent from orders group by user_id) os on us.user_id = os.user_id group by segment;",
        "raw_query": "WITH user_segments AS ( SELECT user_id, CASE WHEN total_orders > 100 THEN 'vip' WHEN total_orders > 10 THEN 'regular' ELSE 'occasional' END as segment FROM (SELECT user_id, COUNT(*) as total_orders FROM orders GROUP BY user_id) sq ) SELECT segment, COUNT(*) as user_count, AVG(total_spent) as avg_spent FROM user_segments us JOIN (SELECT user_id, SUM(total) as total_spent FROM orders GROUP BY user_id) os ON us.user_id = os.user_id GROUP BY segment;",
        "total_time_ms": 14567.89
      }
    ],
    "query_99th_percentile": "15.23 s",
    "query_max_duration": "15.23 s",
    "query_median_duration": "7.89 s",
    "query_min_duration": "45 ms",
    "top_1_percent_slow_queries": 1,
    "total_queries_parsed": 25,
    "total_query_duration": "2m 40s",
    "total_unique_queries": 25
  },
  "summary": {
    "duration": "23h59m35s",
    "end_date": "2025-01-01 23:59:35",
    "error_count": 0,
    "fatal_count": 0,
    "log_count": 0,
    "panic_count": 0,
    "start_date": "2025-01-01 00:00:00",
    "throughput": "0.00 entries/s",
    "total_logs": 197,
    "warning_count": 0
  },
  "temp_files": {
    "avg_size": "79.79 MB",
    "events": [
      {
        "query_id": "se-artDBI",
        "size": "50.00 MB",
        "timestamp": "2025-01-01 00:15:03"
      },
      {
        "query_id": "up-TTbMVk",
        "size": "100.00 MB",
        "timestamp": "2025-01-01 00:35:16"
      },
      {
        "query_id": "up-TTbMVk",
        "size": "24.00 MB",
        "timestamp": "2025-01-01 00:35:18"
      },
      {
        "query_id": "se-t5xfLG",
        "size": "75.00 MB",
        "timestamp": "2025-01-01 01:08:45"
      },
      {
        "size": "200.00 MB",
        "timestamp": "2025-01-01 01:25:00"
      },
      {
        "query_id": "cr-wgSzpj",
        "size": "40.00 MB",
        "timestamp": "2025-01-01 01:25:02"
      },
      {
        "query_id": "se-r0bek4",
        "size": "149.00 MB",
        "timestamp": "2025-01-01 01:42:00"
      },
      {
        "size": "90.00 MB",
        "timestamp": "2025-01-01 02:15:00"
      },
      {
        "size": "60.00 MB",
        "timestamp": "2025-01-01 02:15:00"
      },
      {
        "query_id": "wi-jxdKj2",
        "size": "30.00 MB",
        "timestamp": "2025-01-01 02:15:00"
      },
      {
        "query_id": "se-BPyDv3",
        "size": "120.00 MB",
        "timestamp": "2025-01-01 02:45:30"
      },
      {
        "query_id": "in-Vv5Ky5",
        "size": "80.00 MB",
        "timestamp": "2025-01-01 03:10:00"
      },
      {
        "query_id": "in-cLbna3",
        "size": "64.00 MB",
        "timestamp": "2025-01-01 03:40:15"
      },
      {
        "size": "50.00 MB",
        "timestamp": "2025-01-01 03:55:30"
      },
      {
        "query_id": "up-tiXPwa",
        "size": "20.00 MB",
        "timestamp": "2025-01-01 03:55:30"
      },
      {
        "query_id": "wi-dcjqlQ",
        "size": "100.00 MB",
        "timestamp": "2025-01-01 04:25:45"
      },
      {
        "query_id": "de-NvyXk4",
        "size": "70.00 MB",
        "timestamp": "2025-01-01 04:55:30"
      },
      {
        "query_id": "se-icbHlE",
        "size": "84.00 MB",
        "timestamp": "2025-01-01 05:25:15"
      },
      {
        "query_id": "wi-T9XAxn",
        "size": "110.00 MB",
        "timestamp": "2025-01-01 05:55:15"
      }
    ],
    "queries": [
      {
        "count": 1,
        "id": "cr-wgSzpj",
        "normalized_query": "create temporary table tmp_aggregates as select user_id, date(created_at) as date, count(*) as event_count from events where created_at > now() - interval ? group by user_id, date(created_at);",
        "raw_query": "CREATE TEMPORARY TABLE tmp_aggregates AS SELECT user_id, DATE(created_at) as date, COUNT(*) as event_count FROM events WHERE created_at > NOW() - INTERVAL '90 days' GROUP BY user_id, DATE(created_at);",
        "total_size": "40.00 MB"
      },
      {
        "count": 1,
        "id": "de-NvyXk4",
        "normalized_query": "delete from session_logs where created_at < now() - interval ? and session_id not in (select id from active_sessions);",
        "raw_query": "DELETE FROM session_logs WHERE created_at < NOW() - INTERVAL '30 days' AND session_id NOT IN (SELECT id FROM active_sessions);",
        "total_size": "70.00 MB"
      },
      {
        "count": 1,
        "id": "in-Vv5Ky5",
        "normalized_query": "insert into monthly_reports (month, total_orders, total_revenue, avg_order_value) select date_trunc(?, created_at) as month, count(*) as total_orders, sum(total) as total_revenue, avg(total) as avg_order_value from orders where created_at >= date_trunc(?, current_date - interval ?) and created_at < date_trunc(?, current_date) group by month;",
        "raw_query": "INSERT INTO monthly_reports (month, total_orders, total_revenue, avg_order_value) SELECT DATE_TRUNC('month', created_at) as month, COUNT(*) as total_orders, SUM(total) as total_revenue, AVG(total) as avg_order_value FROM orders WHERE created_at >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '1 month') AND created_at < DATE_TRUNC('month', CURRENT_DATE) GROUP BY month;",
        "total_size": "80.00 MB"
      },
      {
        "count": 1,
        "id": "in-cLbna3",
        "normalized_query": "insert into sessions (user_id, token, expires_at) values (?, ?, ?);",
        "raw_query": "INSERT INTO sessions (user_id, token, expires_at) VALUES (42, 'abc123', '2025-01-02 00:25:00');",
        "total_size": "64.00 MB"
      },
      {
        "count": 1,
        "id": "se-BPyDv3",
        "normalized_query": "select date(o.created_at) as order_date, p.category, sum(oi.quantity * oi.price) as daily_revenue, count(distinct o.user_id) as unique_customers from orders o join order_items oi on o.id = oi.order_id join products p on oi.product_id = p.id where o.created_at > now() - interval ? group by order_date, p.category order by order_date desc, daily_revenue desc;",
        "raw_query": "SELECT DATE(o.created_at) as order_date, p.category, SUM(oi.quantity * oi.price) as daily_revenue, COUNT(DISTINCT o.user_id) as unique_customers FROM orders o JOIN order_items oi ON o.id = oi.order_id JOIN products p ON oi.product_id = p.id WHERE o.created_at > NOW() - INTERVAL '90 days' GROUP BY order_date, p.category ORDER BY order_date DESC, daily_revenue DESC;",
        "total_size": "120.00 MB"
      },
      {
        "count": 1,
        "id": "se-artDBI",
        "normalized_query": "select date_trunc(?, created_at) as hour, count(*) as count, avg(total) as avg_total from orders where created_at > now() - interval ? group by hour order by hour;",
        "raw_query": "SELECT date_trunc('hour', created_at) as hour, COUNT(*) as count, AVG(total) as avg_total FROM orders WHERE created_at > NOW() - INTERVAL '7 days' GROUP BY hour ORDER BY hour;",
        "total_size": "50.00 MB"
      },
      {
        "count": 1,
        "id": "se-icbHlE",
        "normalized_query": "select category, count(*) as total_products, avg(price) as avg_price, min(price) as min_price, max(price) as max_price, sum(stock) as total_stock from products where active = true group by category order by total_products desc;",
        "raw_query": "SELECT category, COUNT(*) as total_products, AVG(price) as avg_price, MIN(price) as min_price, MAX(price) as max_price, SUM(stock) as total_stock FROM products WHERE active = true GROUP BY category ORDER BY total_products DESC;",
        "total_size": "84.00 MB"
      },
      {
        "count": 1,
        "id": "se-r0bek4",
        "normalized_query": "select category, subcategory, count(*) as product_count, avg(price) as avg_price from products where active = true group by category, subcategory order by category, product_count desc;",
        "raw_query": "SELECT category, subcategory, COUNT(*) as product_count, AVG(price) as avg_price FROM products WHERE active = true GROUP BY category, subcategory ORDER BY category, product_count DESC;",
        "total_size": "149.00 MB"
      },
      {
        "count": 1,
        "id": "se-t5xfLG",
        "normalized_query": "select product_id, count(*) as view_count, avg(duration) as avg_duration from product_views where timestamp > now() - interval ? group by product_id order by view_count desc;",
        "raw_query": "SELECT product_id, COUNT(*) as view_count, AVG(duration) as avg_duration FROM product_views WHERE timestamp > NOW() - INTERVAL '7 days' GROUP BY product_id ORDER BY view_count DESC;",
        "total_size": "75.00 MB"
      },
      {
        "count": 2,
        "id": "up-TTbMVk",
        "normalized_query": "update products set stock = stock - orders_temp.quantity from (select product_id, sum(quantity) as quantity from order_items where order_id in (select id from orders where status = ?)) as orders_temp where products.id = orders_temp.product_id;",
        "raw_query": "UPDATE products SET stock = stock - orders_temp.quantity FROM (SELECT product_id, SUM(quantity) as quantity FROM order_items WHERE order_id IN (SELECT id FROM orders WHERE status = 'pending')) as orders_temp WHERE products.id = orders_temp.product_id;",
        "total_size": "124.00 MB"
      },
      {
        "count": 1,
        "id": "up-tiXPwa",
        "normalized_query": "update user_statistics set total_orders = sq.order_count, total_spent = sq.total_spent, last_order_date = sq.last_order, updated_at = now() from ( select user_id, count(*) as order_count, sum(total) as total_spent, max(created_at) as last_order from orders group by user_id ) sq where user_statistics.user_id = sq.user_id;",
        "raw_query": "UPDATE user_statistics SET total_orders = sq.order_count, total_spent = sq.total_spent, last_order_date = sq.last_order, updated_at = NOW() FROM ( SELECT user_id, COUNT(*) as order_count, SUM(total) as total_spent, MAX(created_at) as last_order FROM orders GROUP BY user_id ) sq WHERE user_statistics.user_id = sq.user_id;",
        "total_size": "20.00 MB"
      },
      {
        "count": 1,
        "id": "wi-T9XAxn",
        "normalized_query": "with cohort_data as ( select user_id, date_trunc(?, min(created_at)) as cohort_month, date_trunc(?, created_at) as order_month, count(*) as order_count from orders where created_at > now() - interval ? group by user_id, cohort_month, order_month ) select cohort_month, order_month, count(distinct user_id) as active_users, sum(order_count) as total_orders from cohort_data group by cohort_month, order_month order by cohort_month, order_month;",
        "raw_query": "WITH cohort_data AS ( SELECT user_id, DATE_TRUNC('month', MIN(created_at)) as cohort_month, DATE_TRUNC('month', created_at) as order_month, COUNT(*) as order_count FROM orders WHERE created_at > NOW() - INTERVAL '12 months' GROUP BY user_id, cohort_month, order_month ) SELECT cohort_month, order_month, COUNT(DISTINCT user_id) as active_users, SUM(order_count) as total_orders FROM cohort_data GROUP BY cohort_month, order_month ORDER BY cohort_month, order_month;",
        "total_size": "110.00 MB"
      },
      {
        "count": 1,
        "id": "wi-dcjqlQ",
        "normalized_query": "with daily_metrics as ( select date(created_at) as date, user_id, count(*) as daily_events, sum(duration) as daily_duration from user_events where created_at > now() - interval ? group by date, user_id ) select user_id, avg(daily_events) as avg_daily_events, avg(daily_duration) as avg_daily_duration, max(daily_events) as max_daily_events from daily_metrics group by user_id having avg(daily_events) > ? order by avg_daily_events desc;",
        "raw_query": "WITH daily_metrics AS ( SELECT DATE(created_at) as date, user_id, COUNT(*) as daily_events, SUM(duration) as daily_duration FROM user_events WHERE created_at > NOW() - INTERVAL '30 days' GROUP BY date, user_id ) SELECT user_id, AVG(daily_events) as avg_daily_events, AVG(daily_duration) as avg_daily_duration, MAX(daily_events) as max_daily_events FROM daily_metrics GROUP BY user_id HAVING AVG(daily_events) > 10 ORDER BY avg_daily_events DESC;",
        "total_size": "100.00 MB"
      },
      {
        "count": 1,
        "id": "wi-jxdKj2",
        "normalized_query": "with user_segments as ( select user_id, case when total_orders > ? then ? when total_orders > ? then ? else ? end as segment from (select user_id, count(*) as total_orders from orders group by user_id) sq ) select segment, count(*) as user_count, avg(total_spent) as avg_spent from user_segments us join (select user_id, sum(total) as total_spent from orders group by user_id) os on us.user_id = os.user_id group by segment;",
        "raw_query": "WITH user_segments AS ( SELECT user_id, CASE WHEN total_orders > 100 THEN 'vip' WHEN total_orders > 10 THEN 'regular' ELSE 'occasional' END as segment FROM (SELECT user_id, COUNT(*) as total_orders FROM orders GROUP BY user_id) sq ) SELECT segment, COUNT(*) as user_count, AVG(total_spent) as avg_spent FROM user_segments us JOIN (SELECT user_id, SUM(total) as total_spent FROM orders GROUP BY user_id) os ON us.user_id = os.user_id GROUP BY segment;",
        "total_size": "30.00 MB"
      }
    ],
    "total_messages": 19,
    "total_size": "1.48 GB"
  },
  "users": [
    {
      "count": 58,
      "name": "app_user"
    },
    {
      "count": 14,
      "name": "readonly"
    },
    {
      "count": 13,
      "name": "analytics"
    },
    {
      "count": 12,
      "name": "batch_user"
    },
    {
      "count": 7,
      "name": "admin"
    },
    {
      "count": 3,
      "name": "backup_user"
    },
    {
      "count": 2,
      "name": "postgres"
    }
  ]
}
